<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="NodeJs gives us native access to the local drives. The code below is an example of how to create a custom module that will download a file via promises. No external libraries are required for this exa">
<meta property="og:type" content="article">
<meta property="og:title" content="Downloading Files with NodeJS">
<meta property="og:url" content="http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/index.html">
<meta property="og:site_name" content="Mathieu Dombrock">
<meta property="og:description" content="NodeJs gives us native access to the local drives. The code below is an example of how to create a custom module that will download a file via promises. No external libraries are required for this exa">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-05-23T01:36:58.000Z">
<meta property="article:modified_time" content="2020-07-23T01:37:12.004Z">
<meta property="article:author" content="Mathieu Dombrock">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Downloading Files with NodeJS</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 4.2.1"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/matdombrock" target="_blank" rel="noopener">Code</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/06/22/Using-Git-from-the-Command-Line-Interface/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/04/22/Create-A-New-WordPress-Database-From-MYSQL-CLI/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&text=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&title=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&is_video=false&description=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Downloading Files with NodeJS&body=Check out this article: http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&title=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&title=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&title=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&title=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&name=Downloading Files with NodeJS&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&t=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Setup-Our-Modules"><span class="toc-number">1.</span> <span class="toc-text">Setup Our Modules</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Setup-The-Download-Function"><span class="toc-number">2.</span> <span class="toc-text">Setup The Download Function</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Setup-The-Data"><span class="toc-number">3.</span> <span class="toc-text">Setup The Data</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Determine-Our-Protocol"><span class="toc-number">4.</span> <span class="toc-text">Determine Our Protocol</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Final-Download-js-Code"><span class="toc-number">5.</span> <span class="toc-text">Final Download.js Code</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Using-Our-Module"><span class="toc-number">6.</span> <span class="toc-text">Using Our Module</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Downloading Files with NodeJS
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Mathieu Dombrock</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-05-23T01:36:58.000Z" itemprop="datePublished">2019-05-22</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>NodeJs gives us native access to the local drives. The code below is an example of how to create a custom module that will download a file via promises. No external libraries are required for this example.</p>
<h2 id="Setup-Our-Modules"><a href="#Setup-Our-Modules" class="headerlink" title="Setup Our Modules"></a>Setup Our Modules</h2><p>Create a new file called ‘download.js’.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> https = <span class="built_in">require</span>(<span class="string">'https'</span>);</span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br></pre></td></tr></table></figure>
<p>The ‘http’ and ‘https’ modules are required to make our connection to the site we want to download from.</p>
<p>The ‘fs’ module allows us to access the local file system.</p>
<p>The ‘path’ module allows us to split the URL into useful information.</p>
<h2 id="Setup-The-Download-Function"><a href="#Setup-The-Download-Function" class="headerlink" title="Setup The Download Function"></a>Setup The Download Function</h2><p>Below the previous code enter the following:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">download</span>(<span class="params">options</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Here we setup the new ‘download’ function. We also gave it a parameter named ‘options’ which represents and object that we will use to submit the options for our download (more on that later).</p>
<p>Additionally, we told this function to return a new promise. If you are not sure exactly how promises work, don’t worry, it’s not critical to making this work.</p>
<h2 id="Setup-The-Data"><a href="#Setup-The-Data" class="headerlink" title="Setup The Data"></a>Setup The Data</h2><p>Let’s edit the ‘download’ function to look like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">download</span>(<span class="params">options</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> spec_url = <span class="keyword">new</span> URL(options.input_url);</span><br><span class="line">        <span class="keyword">let</span> file_name = path.basename(options.input_url);</span><br><span class="line">        <span class="keyword">let</span> file = fs.createWriteStream(options.save_location+file_name);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> return_data = &#123;</span><br><span class="line">            <span class="string">"options"</span>:options,</span><br><span class="line">            <span class="string">"file_name"</span>:file_name,</span><br><span class="line">            <span class="string">"save_location"</span>:options.save_location,</span><br><span class="line">            <span class="string">"success"</span>:<span class="literal">false</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The ‘spec_url’ variable will store our “special” URL. The one that can be parsed by our <code>path</code> module. We will use this to determine our protocol. </p>
<p>The ‘file_name’ variable will store the name of our file including its file extension. </p>
<p>The ‘file’ variable will store a reference to the actual file will we write.</p>
<p>The ‘return_data’ object will store the data that we will return when the function completes.</p>
<h2 id="Determine-Our-Protocol"><a href="#Determine-Our-Protocol" class="headerlink" title="Determine Our Protocol"></a>Determine Our Protocol</h2><p>You might have noticed that we needed to import both the ‘http’ and ‘https’ modules. When we want to download a file we need to know if we are going to be accessing it via HTTP or HTTPS so that we can use the right protocol. It would be possible to do this simply by supplying another parameter to the function or adding this to the options object. However we can avoid this (any any potential errors it may cause) by using our special URL we setup earlier.</p>
<p>Go ahead and edit the ‘download’ function to match this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">download</span>(<span class="params">options</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> spec_url = <span class="keyword">new</span> URL(options.input_url);</span><br><span class="line">        <span class="keyword">let</span> file_name = path.basename(options.input_url);</span><br><span class="line">        <span class="keyword">let</span> file = fs.createWriteStream(options.save_location+file_name);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> return_data = &#123;</span><br><span class="line">            <span class="string">"options"</span>:options,</span><br><span class="line">            <span class="string">"file_name"</span>:file_name,</span><br><span class="line">            <span class="string">"save_location"</span>:options.save_location,</span><br><span class="line">            <span class="string">"success"</span>:<span class="literal">false</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(spec_url.protocol == <span class="string">"https:"</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> protocol = https;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (spec_url.protocol == <span class="string">"http:"</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> protocol = http;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.error(<span class="string">"INVALID PROTOCOL"</span>);</span><br><span class="line">            resolve(return_data);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        protocol.get(spec_url, <span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">            response.pipe(file);</span><br><span class="line">            return_data.success = <span class="literal">true</span>;</span><br><span class="line">            resolve(return_data);</span><br><span class="line">        &#125;).on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            <span class="comment">//console.error(e);</span></span><br><span class="line">            resolve(return_data);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>First, you can see we setup some super simple logic to check if the protocol is HTTP or HTTPS. If we can determine the protocol we setup a new ‘protocol’ variable and assign the correct (corresponding) module to it. If we can not determine what protocol we are using, this means we did not supply a valid URL. Here we still resolve the promise, but the ‘return_data’ will still have a value of ‘false’ in the ‘success’ field.</p>
<p>Once we know the correct protocol, we can go ahead and actually download the file, set the ‘success’ field to ‘true’ and resolve our promise with the return data.</p>
<p>We also setup some simple error handling in case something goes wrong. </p>
<h2 id="Final-Download-js-Code"><a href="#Final-Download-js-Code" class="headerlink" title="Final Download.js Code"></a>Final Download.js Code</h2><p>The final code for the ‘download.js’ file should look like this:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//NodeJS</span></span><br><span class="line"><span class="keyword">const</span> https = <span class="built_in">require</span>(<span class="string">'https'</span>);</span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">download</span>(<span class="params">options</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">let</span> spec_url = <span class="keyword">new</span> URL(options.input_url);</span><br><span class="line">        <span class="keyword">let</span> file_name = path.basename(options.input_url);</span><br><span class="line">        <span class="keyword">let</span> file = fs.createWriteStream(options.save_location+file_name);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> return_data = &#123;</span><br><span class="line">            <span class="string">"options"</span>:options,</span><br><span class="line">            <span class="string">"file_name"</span>:file_name,</span><br><span class="line">            <span class="string">"save_location"</span>:options.save_location,</span><br><span class="line">            <span class="string">"success"</span>:<span class="literal">false</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(spec_url.protocol == <span class="string">"https:"</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> protocol = https;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (spec_url.protocol == <span class="string">"http:"</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> protocol = http;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.error(<span class="string">"INVALID PROTOCOL"</span>);</span><br><span class="line">            resolve(return_data);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        protocol.get(spec_url, <span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">            response.pipe(file);</span><br><span class="line">            return_data.success = <span class="literal">true</span>;</span><br><span class="line">            resolve(return_data);</span><br><span class="line">        &#125;).on(<span class="string">'error'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">            <span class="comment">//console.error(e);</span></span><br><span class="line">            resolve(return_data);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">exports.get = <span class="function"><span class="keyword">function</span>(<span class="params">options</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> download(options);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Notice that we added an export (at the very bottom) for this function so that we can use it as a custom module.</p>
<h2 id="Using-Our-Module"><a href="#Using-Our-Module" class="headerlink" title="Using Our Module"></a>Using Our Module</h2><p>Let’s setup a test script so that we can see how our download module actually works. </p>
<p>First we need to make a new directory to store our downloads. Do this now:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#bash</span></span><br><span class="line">mkdir downloads</span><br></pre></td></tr></table></figure>
<p>If you are using Windows just make a new folder called ‘downloads’ in our current directory.</p>
<p>Then make a new file called ‘test.js’ and give it the following content:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> DL = <span class="built_in">require</span>(<span class="string">'./download.js'</span>);</span><br><span class="line"><span class="keyword">let</span> test = DL.get(&#123;</span><br><span class="line">    <span class="string">"input_url"</span>:<span class="string">"https://i.imgur.com/crtV5VDg.jpg"</span>,</span><br><span class="line">    <span class="string">"save_location"</span>:<span class="string">"downloads/"</span></span><br><span class="line">&#125;);</span><br><span class="line">test.then(<span class="function"><span class="keyword">function</span>(<span class="params">return_data</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(return_data.success)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Downloaded "</span>+return_data.file_name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"Could Not Download "</span>+return_data.file_name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>This slightly more complex example will read a text file full of URLs and try to download each of the pages listed in this file.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> DL = <span class="built_in">require</span>(<span class="string">'./download.js'</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> list = [];</span><br><span class="line"><span class="keyword">var</span> download_loc =<span class="string">"downloads/"</span>;</span><br><span class="line"><span class="keyword">var</span> tests = [];</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./urls.txt'</span>, <span class="string">"utf8"</span>, <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="keyword">throw</span> err;</span><br><span class="line">    &#125;</span><br><span class="line">    processFile(data);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">processFile</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    list = data.split(<span class="string">"\n"</span>);</span><br><span class="line">    Run(list);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Run</span>(<span class="params">list</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(item <span class="keyword">in</span> list)&#123;</span><br><span class="line">        tests.push(DL.get(&#123;<span class="string">"input_url"</span>:list[item],<span class="string">"save_location"</span>:download_loc&#125;));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(test <span class="keyword">in</span> tests)&#123;</span><br><span class="line">        tests[test].then(<span class="function"><span class="keyword">function</span>(<span class="params">return_data</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(return_data.success==<span class="literal">true</span>)&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"DOWNLOADED: "</span>+return_data.options.input_url);</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"///"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"ERROR: "</span>+return_data.options.input_url);</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"///"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(error);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>You can find some URLS to use as your ‘urls.txt’ file <a href="https://gist.github.com/demersdesigns/4442cd84c1cc6c5ccda9b19eac1ba52b" target="_blank" rel="noopener">on GitHub</a>.</p>
<hr>
<p>Thanks for reading!</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/matdombrock" target="_blank" rel="noopener">Code</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Setup-Our-Modules"><span class="toc-number">1.</span> <span class="toc-text">Setup Our Modules</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Setup-The-Download-Function"><span class="toc-number">2.</span> <span class="toc-text">Setup The Download Function</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Setup-The-Data"><span class="toc-number">3.</span> <span class="toc-text">Setup The Data</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Determine-Our-Protocol"><span class="toc-number">4.</span> <span class="toc-text">Determine Our Protocol</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Final-Download-js-Code"><span class="toc-number">5.</span> <span class="toc-text">Final Download.js Code</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Using-Our-Module"><span class="toc-number">6.</span> <span class="toc-text">Using Our Module</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&text=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&title=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&is_video=false&description=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Downloading Files with NodeJS&body=Check out this article: http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&title=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&title=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&title=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&title=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&name=Downloading Files with NodeJS&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=http://yoursite.com/2019/05/22/Downloading-Files-with-NodeJS/&t=Downloading Files with NodeJS" target="_blank" rel="noopener"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2020
    Mathieu Dombrock
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/matdombrock" target="_blank" rel="noopener">Code</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
